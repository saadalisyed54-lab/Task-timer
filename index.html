<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offline Task Master</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome (for icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* Smooth transitions for theme changes */
        body {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* Custom Scrollbar for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: transparent; 
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(156, 163, 175, 0.5); 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(156, 163, 175, 0.8); 
        }

        /* Animation for Progress Bar */
        .progress-bar-transition {
            transition: width 1s linear;
        }

        /* Modal Overlay */
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- THEMES CONFIGURATION (20 Themes) ---
        const THEMES = [
            { id: 0, name: "Classic White", bg: "bg-white", text: "text-gray-900", panel: "bg-gray-100", accent: "bg-blue-600", border: "border-gray-200" },
            { id: 1, name: "Night Mode", bg: "bg-gray-900", text: "text-gray-100", panel: "bg-gray-800", accent: "bg-blue-500", border: "border-gray-700" },
            { id: 2, name: "Midnight Blue", bg: "bg-slate-900", text: "text-slate-100", panel: "bg-slate-800", accent: "bg-indigo-500", border: "border-slate-700" },
            { id: 3, name: "Forest", bg: "bg-green-50", text: "text-green-900", panel: "bg-green-100", accent: "bg-green-600", border: "border-green-200" },
            { id: 4, name: "Deep Forest", bg: "bg-green-900", text: "text-green-100", panel: "bg-green-800", accent: "bg-green-500", border: "border-green-700" },
            { id: 5, name: "Sunset", bg: "bg-orange-50", text: "text-orange-900", panel: "bg-orange-100", accent: "bg-orange-600", border: "border-orange-200" },
            { id: 6, name: "Crimson Dark", bg: "bg-red-950", text: "text-red-100", panel: "bg-red-900", accent: "bg-red-600", border: "border-red-800" },
            { id: 7, name: "Lavender", bg: "bg-purple-50", text: "text-purple-900", panel: "bg-purple-100", accent: "bg-purple-600", border: "border-purple-200" },
            { id: 8, name: "Royal Purple", bg: "bg-purple-950", text: "text-purple-100", panel: "bg-purple-900", accent: "bg-purple-500", border: "border-purple-800" },
            { id: 9, name: "Ocean", bg: "bg-cyan-50", text: "text-cyan-900", panel: "bg-cyan-100", accent: "bg-cyan-600", border: "border-cyan-200" },
            { id: 10, name: "Abyss", bg: "bg-black", text: "text-gray-200", panel: "bg-gray-900", accent: "bg-white", border: "border-gray-800" },
            { id: 11, name: "Paper", bg: "bg-stone-100", text: "text-stone-800", panel: "bg-white", accent: "bg-stone-600", border: "border-stone-300" },
            { id: 12, name: "Coffee", bg: "bg-amber-900", text: "text-amber-100", panel: "bg-amber-800", accent: "bg-amber-600", border: "border-amber-700" },
            { id: 13, name: "Rose", bg: "bg-rose-50", text: "text-rose-900", panel: "bg-rose-100", accent: "bg-rose-500", border: "border-rose-200" },
            { id: 14, name: "High Contrast", bg: "bg-white", text: "text-black", panel: "bg-black", accent: "bg-black", border: "border-black" }, // Text inside panel needs override
            { id: 15, name: "Terminal", bg: "bg-black", text: "text-green-500", panel: "bg-gray-900", accent: "bg-green-600", border: "border-green-900" },
            { id: 16, name: "Solarized Light", bg: "bg-[#fdf6e3]", text: "text-[#657b83]", panel: "bg-[#eee8d5]", accent: "bg-[#268bd2]", border: "border-[#d33682]" },
            { id: 17, name: "Solarized Dark", bg: "bg-[#002b36]", text: "text-[#839496]", panel: "bg-[#073642]", accent: "bg-[#2aa198]", border: "border-[#586e75]" },
            { id: 18, name: "Mint", bg: "bg-emerald-50", text: "text-emerald-900", panel: "bg-emerald-100", accent: "bg-emerald-500", border: "border-emerald-200" },
            { id: 19, name: "Berry", bg: "bg-fuchsia-900", text: "text-fuchsia-100", panel: "bg-fuchsia-800", accent: "bg-fuchsia-500", border: "border-fuchsia-700" },
        ];

        // --- HELPER FUNCTIONS ---
        const generateId = () => Date.now().toString(36) + Math.random().toString(36).substr(2);
        
        const formatTime = (ms) => {
            if (ms < 0) ms = 0;
            const hours = Math.floor(ms / 3600000);
            const minutes = Math.floor((ms % 3600000) / 60000);
            const seconds = Math.floor((ms % 60000) / 1000);
            const milliseconds = Math.floor((ms % 1000) / 10); // Show 2 digits
            
            const p = (n) => n.toString().padStart(2, '0');
            return `${hours > 0 ? p(hours) + ':' : ''}${p(minutes)}:${p(seconds)}.${p(milliseconds)}`;
        };

        const App = () => {
            // --- STATE ---
            const [tasks, setTasks] = useState([]);
            const [library, setLibrary] = useState([]);
            const [tokens, setTokens] = useState(0);
            const [themeIndex, setThemeIndex] = useState(0);
            const [activeTab, setActiveTab] = useState('running'); // running, paused, completed, failed, library
            const [logs, setLogs] = useState([]);
            const [showLibraryControls, setShowLibraryControls] = useState(true);
            const [now, setNow] = useState(Date.now()); // Global ticker

            // --- PERSISTENCE & INITIALIZATION ---
            useEffect(() => {
                const storedData = localStorage.getItem('offlineTaskTimerData');
                if (storedData) {
                    const parsed = JSON.parse(storedData);
                    setTasks(parsed.tasks || []);
                    setLibrary(parsed.library || []);
                    setTokens(parsed.tokens || 0);
                    setThemeIndex(parsed.themeIndex || 0);
                    setLogs(parsed.logs || []);
                    setShowLibraryControls(parsed.showLibraryControls ?? true);
                }
            }, []);

            useEffect(() => {
                const dataToSave = { tasks, library, tokens, themeIndex, logs, showLibraryControls };
                localStorage.setItem('offlineTaskTimerData', JSON.stringify(dataToSave));
            }, [tasks, library, tokens, themeIndex, logs, showLibraryControls]);

            // --- TIMER ENGINE ---
            useEffect(() => {
                const interval = setInterval(() => {
                    setNow(Date.now());
                }, 43); // ~23fps update rate is smooth enough for text
                return () => clearInterval(interval);
            }, []);

            // --- LOGGING ---
            const addLog = (action) => {
                const newLog = `${new Date().toLocaleTimeString()}: ${action}`;
                setLogs(prev => [newLog, ...prev].slice(0, 3));
            };

            // --- ACTIONS ---

            const createTask = (name, minutes, reward, penalty, fromLibraryId = null) => {
                if (!name || !minutes) return; // Basic validation (though UI prevents this mostly)
                
                const durationMs = parseFloat(minutes) * 60 * 1000;
                
                const newTask = {
                    id: generateId(),
                    name,
                    durationMs,
                    totalDurationMs: durationMs, // Kept for progress bar
                    reward: parseInt(reward) || 0,
                    penalty: parseInt(penalty) || 0,
                    startTime: Date.now(),
                    remainingMs: durationMs,
                    status: 'running', // running, paused, completed, failed, expired
                    fromLibraryId
                };

                setTasks(prev => [...prev, newTask]);
                addLog(`Started "${name}"`);

                if (fromLibraryId) {
                    setLibrary(prev => prev.map(item => 
                        item.id === fromLibraryId ? { ...item, hasRun: true } : item
                    ));
                }
            };

            const pauseTask = (id) => {
                setTasks(prev => prev.map(t => {
                    if (t.id !== id) return t;
                    // Calculate remaining time at moment of pause
                    const elapsed = Date.now() - t.startTime;
                    const currentRemaining = t.remainingMs - elapsed;
                    return {
                        ...t,
                        status: 'paused',
                        startTime: null,
                        remainingMs: currentRemaining
                    };
                }));
                addLog("Task Paused");
            };

            const resumeTask = (id) => {
                setTasks(prev => prev.map(t => {
                    if (t.id !== id) return t;
                    return {
                        ...t,
                        status: 'running',
                        startTime: Date.now() // New start time, remainingMs stays same
                    };
                }));
                addLog("Task Resumed");
            };

            const completeTask = (id) => {
                setTasks(prev => prev.map(t => {
                    if (t.id !== id) return t;
                    return { ...t, status: 'completed' };
                }));
                const task = tasks.find(t => t.id === id);
                if (task) {
                    setTokens(prev => prev + task.reward);
                    addLog(`Completed "${task.name}" (+${task.reward})`);
                }
            };

            const failTask = (id) => {
                setTasks(prev => prev.map(t => {
                    if (t.id !== id) return t;
                    return { ...t, status: 'failed' };
                }));
                const task = tasks.find(t => t.id === id);
                if (task) {
                    setTokens(prev => prev - task.penalty);
                    addLog(`Failed "${task.name}" (-${task.penalty})`);
                }
            };

            // --- LIBRARY ACTIONS ---
            const addToLibrary = (name, minutes, reward, penalty) => {
                if (!name || !minutes) return;
                const newItem = {
                    id: generateId(),
                    name,
                    minutes,
                    reward: parseInt(reward) || 0,
                    penalty: parseInt(penalty) || 0,
                    hasRun: false
                };
                setLibrary(prev => [...prev, newItem]);
            };

            const deleteFromLibrary = (id) => {
                setLibrary(prev => prev.filter(item => item.id !== id));
            };

            const resetLibraryAvailability = () => {
                setLibrary(prev => prev.map(item => ({ ...item, hasRun: false })));
                addLog("Reset Library Availability");
            };

            // --- RESET ACTIONS ---
            const resetPage = (status) => {
                // If status is 'library', strictly reset statuses? No, usually delete. 
                // But prompt implies reset resets progress.
                if (status === 'library') {
                    // Logic handled by resetLibraryAvailability mainly, but let's clear data
                    // Requirement: "resets all task progress but keeps them."
                    resetLibraryAvailability();
                } else {
                    setTasks(prev => prev.filter(t => t.status !== status));
                    addLog(`Cleared ${status} tasks`);
                }
            };

            const masterReset = () => {
                if(confirm("Delete EVERYTHING? This cannot be undone.")) {
                    setTasks([]);
                    setLibrary([]);
                    setTokens(0);
                    setLogs([]);
                    addLog("Master Reset Performed");
                }
            };

            // --- DERIVED STATE FOR UI ---
            const currentTheme = THEMES[themeIndex];
            
            // Filter tasks based on active tab
            // Note: 'expired' tasks effectively float until handled, but technically are 'running' in logic until popup
            // We need a special handler for expired tasks to trigger the modal.
            
            const expiredTasks = tasks.filter(t => {
                if (t.status !== 'running') return false;
                const elapsed = now - t.startTime;
                return (t.remainingMs - elapsed) <= 0;
            });

            const displayTasks = tasks.filter(t => {
                if (activeTab === 'running') return t.status === 'running' && !expiredTasks.find(et => et.id === t.id);
                if (activeTab === 'paused') return t.status === 'paused';
                if (activeTab === 'completed') return t.status === 'completed';
                if (activeTab === 'failed') return t.status === 'failed';
                return false;
            });

            // --- RENDER HELPERS ---
            
            // Full Screen Modal for Expired Tasks
            const ExpiredModal = () => {
                if (expiredTasks.length === 0) return null;
                const task = expiredTasks[0]; // Handle one at a time

                return (
                    <div className="fixed inset-0 z-50 flex flex-col items-center justify-center modal-overlay text-white p-4">
                        <div className="bg-gray-800 p-8 rounded-2xl shadow-2xl max-w-lg w-full text-center border-4 border-white animate-bounce-slight">
                            <h1 className="text-4xl font-bold mb-4">TIME'S UP!</h1>
                            <p className="text-2xl mb-8 text-gray-300">{task.name}</p>
                            
                            <div className="flex flex-col gap-4">
                                <button 
                                    onClick={() => completeTask(task.id)}
                                    className="bg-green-600 hover:bg-green-500 text-white font-bold py-4 px-8 rounded-xl text-xl transition transform hover:scale-105"
                                >
                                    ‚úÖ Completed (+{task.reward})
                                </button>
                                <button 
                                    onClick={() => failTask(task.id)}
                                    className="bg-red-600 hover:bg-red-500 text-white font-bold py-4 px-8 rounded-xl text-xl transition transform hover:scale-105"
                                >
                                    ‚ùå Not Completed (-{task.penalty})
                                </button>
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className={`min-h-screen ${currentTheme.bg} ${currentTheme.text} transition-colors duration-300 flex flex-col overflow-hidden`}>
                    
                    {/* Header */}
                    <header className={`p-4 shadow-md ${currentTheme.panel} flex justify-between items-center z-10`}>
                        <div className="flex items-center gap-4">
                            <div className="text-2xl font-bold">
                                ü™ô {tokens}
                            </div>
                            <button onClick={() => { setTokens(0); addLog("Tokens Reset"); }} className="text-xs opacity-50 hover:opacity-100 underline">
                                Reset
                            </button>
                        </div>
                        
                        <div className="flex items-center gap-2">
                             {/* Theme Select */}
                             <select 
                                value={themeIndex} 
                                onChange={(e) => { setThemeIndex(Number(e.target.value)); addLog("Theme Changed"); }}
                                className={`text-sm p-2 rounded ${currentTheme.bg} border ${currentTheme.border}`}
                            >
                                {THEMES.map(t => <option key={t.id} value={t.id}>{t.name}</option>)}
                            </select>
                        </div>
                    </header>

                    {/* Activity Log */}
                    <div className={`text-xs p-2 text-center opacity-70 ${currentTheme.text}`}>
                        {logs.map((l, i) => <span key={i} className="mx-2 inline-block">details: {l}</span>)}
                    </div>

                    {/* Navigation */}
                    <nav className="flex overflow-x-auto p-2 gap-2 shrink-0">
                        {['Running', 'Paused', 'Library', 'Completed', 'Failed'].map(tab => {
                            const id = tab.toLowerCase() === 'failed' ? 'failed' : tab.toLowerCase() === 'not completed' ? 'failed' : tab.toLowerCase(); // Map logic
                            // Actually prompts says: Running, Paused, Completed, Not Completed, Permanent Task Library
                            // Mapping names to internal IDs
                            let display = tab;
                            let internal = tab.toLowerCase();
                            if(tab === 'Failed') { display = 'Not Completed'; internal = 'failed'; }
                            
                            const isActive = activeTab === internal;
                            return (
                                <button
                                    key={internal}
                                    onClick={() => setActiveTab(internal)}
                                    className={`px-4 py-2 rounded-full whitespace-nowrap font-medium transition-all ${
                                        isActive 
                                        ? `${currentTheme.accent} text-white shadow-lg` 
                                        : `${currentTheme.panel} opacity-70 hover:opacity-100`
                                    }`}
                                >
                                    {display}
                                </button>
                            );
                        })}
                    </nav>

                    {/* Content Area */}
                    <main className="flex-1 overflow-y-auto p-4 relative">
                        
                        {/* MANUAL TASK CREATION FORM (Visible on Running Tab mainly, or always on top?) 
                            Prompt implies specific pages. Let's put a "Create New Task" block only in Running or Library? 
                            Prompt says "Task Creation... User can start multiple tasks".
                            Let's put a collapsible or sticky creation bar on the Running page.
                        */}
                        {activeTab === 'running' && (
                            <div className={`mb-6 p-4 rounded-xl shadow-sm border ${currentTheme.panel} ${currentTheme.border}`}>
                                <h3 className="font-bold mb-2 opacity-80">New One-Time Task</h3>
                                <form 
                                    onSubmit={(e) => {
                                        e.preventDefault();
                                        const form = e.target;
                                        createTask(
                                            form.tName.value, 
                                            form.tTime.value, 
                                            form.tRew.value, 
                                            form.tPen.value
                                        );
                                        form.reset();
                                    }}
                                    className="grid grid-cols-2 md:grid-cols-5 gap-2"
                                >
                                    <input name="tName" placeholder="Task Name" className={`p-2 rounded border ${currentTheme.bg} ${currentTheme.border} col-span-2 md:col-span-2`} required />
                                    <input name="tTime" type="number" step="0.1" placeholder="Mins" className={`p-2 rounded border ${currentTheme.bg} ${currentTheme.border}`} required />
                                    <input name="tRew" type="number" placeholder="Reward" className={`p-2 rounded border ${currentTheme.bg} ${currentTheme.border}`} />
                                    <input name="tPen" type="number" placeholder="Penalty" className={`p-2 rounded border ${currentTheme.bg} ${currentTheme.border}`} />
                                    <button type="submit" className={`${currentTheme.accent} text-white p-2 rounded font-bold col-span-2 md:col-span-5 mt-2`}>
                                        START TASK
                                    </button>
                                </form>
                            </div>
                        )}

                        {/* LIBRARY PAGE */}
                        {activeTab === 'library' && (
                            <div className="space-y-6">
                                {/* Library Creator */}
                                <div className={`p-4 rounded-xl border ${currentTheme.panel} ${currentTheme.border}`}>
                                    <h3 className="font-bold mb-2">Add to Library</h3>
                                    <form 
                                        onSubmit={(e) => {
                                            e.preventDefault();
                                            const form = e.target;
                                            addToLibrary(form.lName.value, form.lTime.value, form.lRew.value, form.lPen.value);
                                            form.reset();
                                        }}
                                        className="grid grid-cols-2 gap-2"
                                    >
                                        <input name="lName" placeholder="Task Name" className={`p-2 rounded border ${currentTheme.bg} ${currentTheme.border} col-span-2`} required />
                                        <input name="lTime" type="number" placeholder="Mins" className={`p-2 rounded border ${currentTheme.bg} ${currentTheme.border}`} required />
                                        <div className="col-span-1 flex gap-2">
                                            <input name="lRew" type="number" placeholder="Reward" className={`w-full p-2 rounded border ${currentTheme.bg} ${currentTheme.border}`} />
                                            <input name="lPen" type="number" placeholder="Penalty" className={`w-full p-2 rounded border ${currentTheme.bg} ${currentTheme.border}`} />
                                        </div>
                                        <button type="submit" className={`${currentTheme.accent} text-white p-2 rounded font-bold col-span-2`}>Save Template</button>
                                    </form>
                                </div>

                                {/* Controls */}
                                <div className="flex justify-between items-center bg-black/5 p-2 rounded">
                                    <button 
                                        onClick={() => setShowLibraryControls(!showLibraryControls)}
                                        className={`text-sm px-3 py-1 rounded border ${currentTheme.border} ${showLibraryControls ? currentTheme.accent + ' text-white' : ''}`}
                                    >
                                        {showLibraryControls ? "Controls: ON" : "Controls: OFF"}
                                    </button>
                                    <button 
                                        onClick={resetLibraryAvailability}
                                        className="text-sm underline hover:font-bold"
                                    >
                                        Reset All Tasks (Allow Start)
                                    </button>
                                </div>

                                {/* List */}
                                <div className="grid gap-3 md:grid-cols-2">
                                    {library.map(item => (
                                        <div key={item.id} className={`p-4 rounded-xl border relative ${currentTheme.panel} ${currentTheme.border}`}>
                                            <div className="flex justify-between items-start mb-2">
                                                <h4 className="font-bold text-lg">{item.name}</h4>
                                                {showLibraryControls && (
                                                    <button onClick={() => deleteFromLibrary(item.id)} className="text-red-500 hover:text-red-700">
                                                        <i className="fas fa-trash"></i>
                                                    </button>
                                                )}
                                            </div>
                                            <div className="text-sm opacity-70 mb-4 flex gap-4">
                                                <span>‚è± {item.minutes}m</span>
                                                <span>ü™ô +{item.reward} / -{item.penalty}</span>
                                            </div>
                                            
                                            {/* Start Button Logic */}
                                            {showLibraryControls && (
                                                <button
                                                    onClick={() => createTask(item.name, item.minutes, item.reward, item.penalty, item.id)}
                                                    disabled={item.hasRun}
                                                    className={`w-full py-2 rounded font-bold transition-all ${
                                                        item.hasRun 
                                                        ? 'bg-gray-400 cursor-not-allowed opacity-50' 
                                                        : `${currentTheme.accent} text-white shadow-lg hover:brightness-110`
                                                    }`}
                                                >
                                                    {item.hasRun ? "Already Started" : "Start Task"}
                                                </button>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* RUNNING / PAUSED / COMPLETED / FAILED LISTS */}
                        {activeTab !== 'library' && (
                            <div className="space-y-4 pb-20">
                                {displayTasks.length === 0 && (
                                    <div className="text-center opacity-40 mt-10">No tasks here.</div>
                                )}

                                {displayTasks.map(task => {
                                    // Calculate Time for Running Tasks
                                    let displayTime = "00:00.00";
                                    let progressPercent = 0;

                                    if (task.status === 'running') {
                                        const elapsed = now - task.startTime;
                                        const remaining = Math.max(0, task.remainingMs - elapsed);
                                        displayTime = formatTime(remaining);
                                        progressPercent = (remaining / task.totalDurationMs) * 100;
                                    } else if (task.status === 'paused') {
                                        displayTime = formatTime(task.remainingMs);
                                        progressPercent = (task.remainingMs / task.totalDurationMs) * 100;
                                    } else {
                                        // Completed/Failed just show totals
                                        displayTime = formatTime(task.totalDurationMs);
                                    }

                                    const isDone = task.status === 'completed' || task.status === 'failed';

                                    return (
                                        <div key={task.id} className={`p-4 rounded-xl border shadow-sm relative overflow-hidden ${currentTheme.panel} ${currentTheme.border}`}>
                                            
                                            {/* Background Progress Bar for Running/Paused */}
                                            {!isDone && (
                                                <div 
                                                    className={`absolute bottom-0 left-0 h-1.5 ${currentTheme.accent} transition-all duration-100 ease-linear`}
                                                    style={{ width: `${progressPercent}%` }}
                                                ></div>
                                            )}

                                            <div className="flex justify-between items-center mb-2 relative z-10">
                                                <h3 className="font-bold text-xl truncate pr-2">{task.name}</h3>
                                                <span className="font-mono text-xl opacity-90">{displayTime}</span>
                                            </div>

                                            {/* Info Row */}
                                            <div className="flex gap-4 text-sm opacity-70 mb-4 relative z-10">
                                                {isDone ? (
                                                    <span>Total Time: {formatTime(task.totalDurationMs)}</span>
                                                ) : (
                                                    <>
                                                        <span>Reward: {task.reward}</span>
                                                        <span>Penalty: {task.penalty}</span>
                                                    </>
                                                )}
                                                {isDone && task.status === 'completed' && <span>Reward: {task.reward}</span>}
                                                {isDone && task.status === 'failed' && <span>Penalty: {task.penalty}</span>}
                                            </div>

                                            {/* Controls */}
                                            <div className="flex gap-2 relative z-10">
                                                {task.status === 'running' && (
                                                    <>
                                                        <button onClick={() => pauseTask(task.id)} className="flex-1 bg-yellow-500 hover:bg-yellow-600 text-white py-2 rounded font-bold">
                                                            <i className="fas fa-pause mr-1"></i> Pause
                                                        </button>
                                                        <button onClick={() => completeTask(task.id)} className="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded font-bold">
                                                            ‚úÖ
                                                        </button>
                                                        <button onClick={() => failTask(task.id)} className="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded font-bold">
                                                            ‚ùå
                                                        </button>
                                                    </>
                                                )}

                                                {task.status === 'paused' && (
                                                    <button onClick={() => resumeTask(task.id)} className="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded font-bold">
                                                        <i className="fas fa-play mr-1"></i> Resume
                                                    </button>
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}

                                {/* Page Reset Button */}
                                {displayTasks.length > 0 && (
                                    <div className="mt-8 text-center">
                                        <button 
                                            onClick={() => resetPage(activeTab)}
                                            className="text-xs text-red-400 border border-red-200 px-3 py-1 rounded hover:bg-red-50 hover:text-red-600 transition"
                                        >
                                            Reset {activeTab} Page
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}
                        
                        {/* Footer / Master Reset */}
                        <div className="h-16"></div> {/* Spacer */}
                        <div className="fixed bottom-0 left-0 right-0 p-2 flex justify-center pointer-events-none">
                            <button 
                                onClick={masterReset} 
                                className="pointer-events-auto opacity-30 hover:opacity-100 bg-red-800 text-white text-[10px] px-2 py-1 rounded shadow-lg transition-opacity"
                            >
                                MASTER RESET
                            </button>
                        </div>
                    </main>

                    {/* Popups */}
                    <ExpiredModal />

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

